import React from 'react';

import { renderWithProviders } from '@/mock-handlers/test-utils';
import SearchResults from '@/app/search/result';
import { screen } from '@testing-library/react';

jest.mock('next/navigation', () => jest.requireActual('next-router-mock'));

const mockResponse = {
  products: [
    {
      id: 'prod_01HE36V2X38H22N8T7PYNSNPF1',
      title: null,
      subtitle: null,
      status: 'published',
      external_id: null,
      description: null,
      handle: 'handle348',
      is_giftcard: false,
      discountable: true,
      thumbnail:
        'https://storageweweb.blob.core.windows.net/files/INVENTORYDATA/Cert/6421960449.Jpeg',
      collection_id: null,
      type_id: null,
      weight: 1.03,
      length: 5.52,
      height: null,
      width: 5.34,
      hs_code: null,
      origin_country: null,
      mid_code: null,
      material: null,
      created_at: '2023-10-31T15:49:58.791Z',
      updated_at: '2023-10-31T15:49:58.791Z',
      deleted_at: null,
      metadata: null,
      profile_id: 'sp_01HDGAAGY7Z6C2BCA07AXQRBA6',
      color: 'J',
      shape: 'AS',
      clarity: 'SI1',
      shape_detail: {
        name: 'AS',
        fullname: 'Asscher',
        id: '7',
        created_at: '2023-10-29T17:08:05.625Z',
        updated_at: '2023-10-29T17:08:05.625Z',
      },
      cut: null,
      polish: 'EX',
      symmetry: 'VG',
      fluorescence: 'NON',
      lab: 'GIA',
      rpt_number: '432410936',
      certificate_url:
        'https://storageweweb.blob.core.windows.net/files/INVENTORYDATA/Certificates/6421960449.pdf',
      girdle: 'THK to VTK',
      location: 'IND',
      color_shade: 'YEL',
      color_shade_intensity: null,
      overtone: null,
      intensity: 'N',
      ha: 'EX',
      brilliance: 'EX',
      black_table: 'B2',
      side_black: 'SBPP',
      open_crown: 'N',
      open_table: 'N',
      open_pavilion: 'VS',
      milky: 'M0',
      luster: 'EX',
      eye_clean: 'Y',
      table_inclusion: 'T1',
      side_inclusion: 'S1',
      natural_crown: 'N',
      natural_girdle: 'N',
      natural_pavilion: 'N',
      surface_graining: 'G1',
      internal_graining: 'IG0',
      carat: 4.4,
      discount: -62.94,
      price_range: null,
      price_per_carat: 3000,
      girdle_percentage: 0,
      pavilion_angle: 0,
      star_length: 0,
      depth_percentage: 30,
      table_percentage: 65,
      crown_angle: 0,
      pavilion_depth: 0,
      crown_height: 0,
      lower_half: 0,
      ratio: 0,
      depth: 68.6,
      certificate_number: '6421960449',
      rap: 1000,
      rap_value: 1000,
      culet: 'NON',
      inscription: 'GIA 6421960449 ',
      tracr_id: null,
      total_grade: null,
      disclosed_source: null,
      is_memo_out: null,
      lot_id: '432410936',
      diamond_status: 'Active',
      in_cart: [],
      collection: null,
      images: [
        {
          id: 'img_01HE36V2X0K8H6GQSCJM726HYC',
          created_at: '2023-10-31T15:49:58.791Z',
          updated_at: '2023-10-31T15:49:58.791Z',
          deleted_at: null,
          url: 'https://storageweweb.blob.core.windows.net/files/INVENTORYDATA/Cert/6421960449.Jpeg',
          metadata: null,
        },
      ],
      options: [
        {
          id: 'opt_01HE36V2X8V68B7J5MEKF7612W',
          created_at: '2023-10-31T15:49:58.791Z',
          updated_at: '2023-10-31T15:49:58.791Z',
          deleted_at: null,
          title: 'diamond',
          product_id: 'prod_01HE36V2X38H22N8T7PYNSNPF1',
          metadata: null,
          values: [
            {
              id: 'optval_01HE36V2XPNB551DW5W33REKHY',
              created_at: '2023-10-31T15:49:58.791Z',
              updated_at: '2023-10-31T15:49:58.791Z',
              deleted_at: null,
              value: 'diamond',
              option_id: 'opt_01HE36V2X8V68B7J5MEKF7612W',
              variant_id: 'variant_01HE36V2XPNFCVN0R0CXTNDXVK',
              metadata: null,
            },
          ],
        },
      ],
      profiles: [
        {
          id: 'sp_01HDGAAGY7Z6C2BCA07AXQRBA6',
          created_at: '2023-10-24T07:45:25.385Z',
          updated_at: '2023-10-24T07:45:25.385Z',
          deleted_at: null,
          name: 'Default Shipping Profile',
          type: 'default',
          metadata: null,
        },
      ],
      tags: [],
      type: null,
      variants: [
        {
          id: 'variant_01HE36V2XPNFCVN0R0CXTNDXVK',
          created_at: '2023-10-31T15:49:58.791Z',
          updated_at: '2023-10-31T15:49:58.791Z',
          deleted_at: null,
          title: 'diamond',
          product_id: 'prod_01HE36V2X38H22N8T7PYNSNPF1',
          sku: null,
          barcode: null,
          ean: null,
          upc: null,
          variant_rank: 0,
          inventory_quantity: 100,
          allow_backorder: false,
          manage_inventory: true,
          hs_code: null,
          origin_country: null,
          mid_code: null,
          material: null,
          weight: null,
          length: null,
          height: null,
          width: null,
          metadata: null,
          options: [
            {
              id: 'optval_01HE36V2XPNB551DW5W33REKHY',
              created_at: '2023-10-31T15:49:58.791Z',
              updated_at: '2023-10-31T15:49:58.791Z',
              deleted_at: null,
              value: 'diamond',
              option_id: 'opt_01HE36V2X8V68B7J5MEKF7612W',
              variant_id: 'variant_01HE36V2XPNFCVN0R0CXTNDXVK',
              metadata: null,
            },
          ],
          prices: [
            {
              id: 'ma_01HE36V2XXEFP971SK45KBRWFR',
              created_at: '2023-10-31T15:49:58.791Z',
              updated_at: '2023-10-31T15:49:58.791Z',
              deleted_at: null,
              currency_code: 'usd',
              amount: 1950,
              min_quantity: null,
              max_quantity: null,
              price_list_id: null,
              region_id: null,
              price_list: null,
              variant_id: 'variant_01HE36V2XPNFCVN0R0CXTNDXVK',
            },
          ],
          original_price: null,
          calculated_price: null,
          original_price_incl_tax: null,
          calculated_price_incl_tax: null,
          original_tax: null,
          calculated_tax: null,
          tax_rates: null,
        },
      ],
    },
    {
      id: 'prod_01HE36WMHKGAA6DPFPZDCFW17G',
      title: null,
      subtitle: null,
      status: 'published',
      external_id: null,
      description: null,
      handle: 'handle1822',
      is_giftcard: false,
      discountable: true,
      thumbnail:
        'https://storageweweb.blob.core.windows.net/files/INVENTORYDATA/Cert/6445728348.Jpeg',
      collection_id: null,
      type_id: null,
      weight: 0.6,
      length: 4.61,
      height: null,
      width: 4.47,
      hs_code: null,
      origin_country: null,
      mid_code: null,
      material: null,
      created_at: '2023-10-31T15:49:58.791Z',
      updated_at: '2023-10-31T15:49:58.791Z',
      deleted_at: null,
      metadata: null,
      profile_id: 'sp_01HDGAAGY7Z6C2BCA07AXQRBA6',
      color: 'I',
      shape: 'AS',
      clarity: 'VVS1',
      shape_detail: {
        name: 'AS',
        fullname: 'Asscher',
        id: '7',
        created_at: '2023-10-29T17:08:05.625Z',
        updated_at: '2023-10-29T17:08:05.625Z',
      },
      cut: null,
      polish: 'EX',
      symmetry: 'VG',
      fluorescence: 'NON',
      lab: 'GIA',
      rpt_number: '434262365',
      certificate_url:
        'https://storageweweb.blob.core.windows.net/files/INVENTORYDATA/Certificates/6445728348.pdf',
      girdle: 'THK to VTK',
      location: 'IND',
      color_shade: 'WH',
      color_shade_intensity: null,
      overtone: null,
      intensity: 'N',
      ha: 'EX',
      brilliance: 'EX',
      black_table: 'B0',
      side_black: 'SB0',
      open_crown: 'N',
      open_table: 'N',
      open_pavilion: 'N',
      milky: 'M0',
      luster: 'EX',
      eye_clean: 'Y',
      table_inclusion: 'T0',
      side_inclusion: 'S0',
      natural_crown: 'N',
      natural_girdle: 'N',
      natural_pavilion: 'N',
      surface_graining: 'G0',
      internal_graining: 'IG0',
      carat: 1.4,
      discount: -51,
      price_range: null,
      price_per_carat: 3000,
      girdle_percentage: 0,
      pavilion_angle: 0,
      star_length: 0,
      depth_percentage: null,
      table_percentage: 65,
      crown_angle: 0,
      pavilion_depth: 0,
      crown_height: 0,
      lower_half: 0,
      ratio: 0,
      depth: 67.2,
      certificate_number: '6445728348',
      rap: 1000,
      rap_value: 1000,
      culet: 'NON',
      inscription: 'GIA 6445728348 ',
      tracr_id: null,
      total_grade: null,
      disclosed_source: null,
      is_memo_out: null,
      lot_id: '434262365',
      diamond_status: 'Active',
      in_cart: [],
      collection: null,
      images: [
        {
          id: 'img_01HE36WMHGWS78E7WHG384TA56',
          created_at: '2023-10-31T15:49:58.791Z',
          updated_at: '2023-10-31T15:49:58.791Z',
          deleted_at: null,
          url: 'https://storageweweb.blob.core.windows.net/files/INVENTORYDATA/Cert/6445728348.Jpeg',
          metadata: null,
        },
      ],
      options: [
        {
          id: 'opt_01HE36WMHRMWBPC815RAYHY9QW',
          created_at: '2023-10-31T15:49:58.791Z',
          updated_at: '2023-10-31T15:49:58.791Z',
          deleted_at: null,
          title: 'diamond',
          product_id: 'prod_01HE36WMHKGAA6DPFPZDCFW17G',
          metadata: null,
          values: [
            {
              id: 'optval_01HE36WMJ7GGEKQJGBXNFJFPV9',
              created_at: '2023-10-31T15:49:58.791Z',
              updated_at: '2023-10-31T15:49:58.791Z',
              deleted_at: null,
              value: 'diamond',
              option_id: 'opt_01HE36WMHRMWBPC815RAYHY9QW',
              variant_id: 'variant_01HE36WMJ76FVFKXAPN4KYHGPA',
              metadata: null,
            },
          ],
        },
      ],
      profiles: [
        {
          id: 'sp_01HDGAAGY7Z6C2BCA07AXQRBA6',
          created_at: '2023-10-24T07:45:25.385Z',
          updated_at: '2023-10-24T07:45:25.385Z',
          deleted_at: null,
          name: 'Default Shipping Profile',
          type: 'default',
          metadata: null,
        },
      ],
      tags: [],
      type: null,
      variants: [
        {
          id: 'variant_01HE36WMJ76FVFKXAPN4KYHGPA',
          created_at: '2023-10-31T15:49:58.791Z',
          updated_at: '2023-10-31T15:49:58.791Z',
          deleted_at: null,
          title: 'diamond',
          product_id: 'prod_01HE36WMHKGAA6DPFPZDCFW17G',
          sku: null,
          barcode: null,
          ean: null,
          upc: null,
          variant_rank: 0,
          inventory_quantity: 100,
          allow_backorder: false,
          manage_inventory: true,
          hs_code: null,
          origin_country: null,
          mid_code: null,
          material: null,
          weight: null,
          length: null,
          height: null,
          width: null,
          metadata: null,
          options: [
            {
              id: 'optval_01HE36WMJ7GGEKQJGBXNFJFPV9',
              created_at: '2023-10-31T15:49:58.791Z',
              updated_at: '2023-10-31T15:49:58.791Z',
              deleted_at: null,
              value: 'diamond',
              option_id: 'opt_01HE36WMHRMWBPC815RAYHY9QW',
              variant_id: 'variant_01HE36WMJ76FVFKXAPN4KYHGPA',
              metadata: null,
            },
          ],
          prices: [
            {
              id: 'ma_01HE36WMJESG9Y8DVAW87E35R0',
              created_at: '2023-10-31T15:49:58.791Z',
              updated_at: '2023-10-31T15:49:58.791Z',
              deleted_at: null,
              currency_code: 'usd',
              amount: 1950,
              min_quantity: null,
              max_quantity: null,
              price_list_id: null,
              region_id: null,
              price_list: null,
              variant_id: 'variant_01HE36WMJ76FVFKXAPN4KYHGPA',
            },
          ],
          original_price: null,
          calculated_price: null,
          original_price_incl_tax: null,
          calculated_price_incl_tax: null,
          original_tax: null,
          calculated_tax: null,
          tax_rates: null,
        },
      ],
    },
  ],
  count: 2,
  offset: 0,
  limit: 300,
};

describe('Render Search Result Page', () => {
  // Common test setup
  beforeEach(() => {
    renderWithProviders(<SearchResults data={mockResponse} activeTab={1} />);
  });

  test('renders Search Result Page', () => {
    expect(screen.getByText(/pieces/i)).toHaveTextContent('0/2');
    expect(screen.getByText(/Total Avg. Dis/i)).toHaveTextContent('0.00');
    expect(screen.getByText(/Total Amount/i)).toHaveTextContent('$0.0');
    expect(screen.queryByText(/save this search/i)).toBeInTheDocument();
    expect(screen.getByText(/Loading.../i)).toBeInTheDocument();
  });
});
